{
    "collab_server" : "",
    "contents" : "###manually define subclusters in data \nsource(\"get_apo_proteins.R\")\nlibrary(ggExtra)\nlibrary(ggplot2)\nfull.data.2$pdb_id = row.names(full.data.2)\n\nfull.data.px.vec  = merge(full.data.2, dat.rel.col[,c(1,4,5)], by = \"pdb_id\" ) \nhead(full.data.px.vec)\ncolors = c(\"#443333\",\"#cc5522\",\"#00ccff\",\"#AA96DA\", \"grey50\")\ncodisubclusters = ggplot(full.data.px.vec[which(full.data.px.vec$V15==\"codi\"),], aes(p1p1x.y , p2p2x.y))  + geom_point(size = 20, alpha =.9, color = \"#30B096\") + ggtitle(\"codi subclusters\")   + theme_light(base_size = 20)  +   ylim(0,1) + theme(legend.position = \"none\") \nggMarginal(codisubclusters,type = \"histogram\",  binwidth = .01 , size = 6)\n\ncidisubclusters = ggplot(full.data.px.vec[which(full.data.px.vec$V15==\"cidi\"),], aes(p1p1x.y , p2p2x.y))  + geom_point(size =20, alpha =.9, color = \"#443333\") + ggtitle(\"cidi subclusters\")   + theme_light(base_size = 20)  +  ylim(0,1) + theme(legend.position = \"none\")   +  theme_bw(base_size = 20) + theme(axis.title = element_blank(), axis.text = element_text(size = 60), panel.border = element_rect(colour = \"black\", fill=NA, size=1.5) , legend.text = element_text(size = 60), legend.position = \"none\")\nggMarginal(cidisubclusters,type = \"histogram\",  size = 6, binwidth = .1)\n\ncidosubclusters = ggplot(full.data.px.vec[which(full.data.px.vec$V15==\"cido\"),], aes(p1p1x.y , p2p2x.y))  + geom_point(size =20, alpha =.9, color = \"#cc5522\") + ggtitle(\"cido subclusters\")   + theme_light(base_size = 20)  +  ylim(-1,0) + xlim(-1,0) + theme(legend.position = \"none\") +  theme_bw(base_size = 20) + theme(axis.title = element_blank(), axis.text = element_text(size = 60), panel.border = element_rect(colour = \"black\", fill=NA, size=1.5) , legend.text = element_text(size = 60), legend.position = \"none\")\n\nggMarginal(cidosubclusters,type = \"histogram\",  size = 6, binwidth = .01)\n+ geom_hline(yintercept = .63) + geom_vline(xintercept = .5)\n\ncodosubclusters = ggplot(full.data.px.vec[which(full.data.px.vec$V15==\"codo\"),], aes(p1p1x.y , p2p2x.y))  + geom_point(size = 20, alpha =.9, color = \"#AA96DA\") + ggtitle(\"codo subclusters\")   + theme_light(base_size = 20) +  ylim(-1,0) + xlim(-1,0) + theme(legend.position = \"none\")  +  theme_bw(base_size = 20) + theme(axis.title = element_blank(), axis.text = element_text(size = 60), panel.border = element_rect(colour = \"black\", fill=NA, size=1.5) , legend.text = element_text(size = 60), legend.position = \"none\")\nggMarginal(codosubclusters,type = \"histogram\",  size = 6, binwidth = .01)\n+ geom_hline(yintercept = .63) + geom_vline(xintercept = .5)\n\nothersubclusters = ggplot(full.data.px.vec[which(full.data.px.vec$V15==\"other\"),], aes(p1p1x.y , p2p2x.y))  + geom_point(size = 20, alpha =.9, color = \"grey50\") + ggtitle(\"other subclusters\")   + theme_light(base_size = 20)  + ylim(-1,1) + theme(legend.position = \"none\") +  theme_bw(base_size = 20) + theme(axis.title = element_blank(), axis.text = element_text(size = 60), panel.border = element_rect(colour = \"black\", fill=NA, size=1.5) , legend.text = element_text(size = 60), legend.position = \"none\")\nggMarginal(othersubclusters,type = \"histogram\",  size = 6, binwidth = .01)\n+ geom_hline(yintercept = .63) + geom_vline(xintercept = .5)\n\ncodi = full.data.2[which(full.data.2$V15 == \"codi\"), ]\nhead(codi)\ncodi[which(codi$p2p2x >= .63 & codi$p1p1x < .5), 21] = 1\ncodi[which(codi$p2p2x < .63 & codi$p1p1x < .5), 21 ] = 2\ncodi[which(codi$p2p2x >= .63 & codi$p1p1x >= .5), 21 ] = 3\ncodi[which(codi$p2p2x < .63 & codi$p1p1x >= .5), 21 ] = 4\nclus =kmeans(codi[,c(1:2)], centers = 3 )\ncodi$cl = clus$cluster\nggplot(codi, aes(codi$p1p1x, codi$p2p2x, color = factor(codi$cl))) + geom_point(size = 20, alpha = .9)  + geom_abline(slope = 0 , intercept = 0, size = 1.5) +  theme_bw(base_size = 20) + theme(axis.title = element_blank(), axis.text = element_text(size = 60), panel.border = element_rect(colour = \"black\", fill=NA, size=1.5) , legend.text = element_text(size = 60), legend.position = \"none\")\nggMarginal(p,type = \"histogram\",  size = 6, binwidth = .01)\ncodi[which(codi$cl==1),23] = (codi[which(codi$cl==1),1] - 0.8259137 )^2 + (codi[which(codi$cl==1),2] - 0.8423546 )^2\ncodi[which(codi$cl==2),23] = (codi[which(codi$cl==2),1] - 0.2676688 )^2 + (codi[which(codi$cl==2),2] - 0.4816065 )^2\ncodi[which(codi$cl==3),23] = (codi[which(codi$cl==3),1] - 0.2701360 )^2 + (codi[which(codi$cl==3),2] - 0.7902117 )^2\ncodi.dist = codi$V23 \ncodi$distance_from_center = codi.dist\ncodi$V23 = NULL\ncodi.sub = codi$cl\ncodi$subclusters = codi$cl\ncodi$cl = NULL\nwrite.table(codi, \"../../2_predicted_classes/9.1.17.codi_subclusters.csv\",quote = F, row.names = T, col.names = T, sep = \",\" )\n\nclus$centers\n\nlibrary(ggplot2) \ncodi.2 = codi[,c(1:13)]\nhead(codi.2)\nggplot(stack(codi.2), aes(ind, values)) + geom_boxplot()\nhead(codi)\n\nphipsi = dat[2:nrow(dat),c(2,21,22)]\nphipsi = phipsi[complete.cases(phipsi),]\nrow.names(phipsi) = phipsi$pdb_id.1\nfull.data.phi = merge(full.data.2, phipsi, by = 0 )\nggplot(full.data.phi, aes(h_phi, h_psi, color = factor(toupper(V15)))) + \n  scale_color_manual(values = colors) +\n  geom_point(size = 20, alpha = .7) + \n  geom_abline(slope = 0 , intercept = 0, size = 1.5) + \n  theme_bw(base_size = 20) + \n  theme(axis.text = element_text(size = 60), panel.border = element_rect(colour = \"black\", fill=NA, size=1.5) , legend.text = element_text(size = 60))\n\n\n\n\n\n",
    "created" : 1507875013349.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4208159996",
    "id" : "7FB08CFC",
    "lastKnownWriteTime" : 1504976625,
    "last_content_update" : 1504976625,
    "path" : "~/Dropbox (Schlessinger lab)/Schlessinger lab Team Folder/shared/1_kinase_family/scripts/kinase_classification_r_project/define subclusters.R",
    "project_path" : "define subclusters.R",
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}